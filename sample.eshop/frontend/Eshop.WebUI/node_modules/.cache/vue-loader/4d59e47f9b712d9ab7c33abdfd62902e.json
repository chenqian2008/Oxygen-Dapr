{"remainingRequest":"E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\src\\view\\cart\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\src\\view\\cart\\index.vue","mtime":1578140814805},{"path":"E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\dotnet_project\\Oxygen-EshopSample\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBnbG9iYWwgZnJvbSAiLi4vY29tbW9uIjsKaW1wb3J0IHsKICBDaGVja2JveCwKICBDaGVja2JveEdyb3VwLAogIENhcmQsCiAgU3VibWl0QmFyLAogIFRvYXN0LAogIFN0ZXBwZXIsCiAgQ2VsbCwKICBJbWFnZSwKICBOYXZCYXIsCiAgQnV0dG9uCn0gZnJvbSAidmFudCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgW0NhcmQubmFtZV06IENhcmQsCiAgICBbQ2hlY2tib3gubmFtZV06IENoZWNrYm94LAogICAgW1N1Ym1pdEJhci5uYW1lXTogU3VibWl0QmFyLAogICAgW0NoZWNrYm94R3JvdXAubmFtZV06IENoZWNrYm94R3JvdXAsCiAgICBbU3RlcHBlci5uYW1lXTogU3RlcHBlciwKICAgIFtDZWxsLm5hbWVdOiBDZWxsLAogICAgW0ltYWdlLm5hbWVdOiBJbWFnZSwKICAgIFtOYXZCYXIubmFtZV06IE5hdkJhciwKICAgIFtCdXR0b24ubmFtZV06IEJ1dHRvbgogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjaGVja2VkR29vZHM6IHsKICAgICAgICBhbGxjaGVjazogZmFsc2UsCiAgICAgICAgdG90YWxQcmljZTogMC4wLAogICAgICAgIGNhblN1Ym1pdDogZmFsc2UKICAgICAgfSwKICAgICAgZ29vZHM6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZm9ybWF0UHJpY2UocHJpY2UpIHsKICAgICAgcmV0dXJuIChwcmljZSAvIDEwMCkudG9GaXhlZCgyKTsKICAgIH0sCiAgICBvblN1Ym1pdCgpIHsKICAgICAgLy/liJvlu7rorqLljZUKICAgICAgdmFyIEdvb2RzTGlzdCA9IFtdOwogICAgICB0aGlzLmdvb2RzLmZvckVhY2goeCA9PiB7CiAgICAgICAgaWYgKHguY2hvb3NlKSBHb29kc0xpc3QucHVzaCh7IEdvb2RzSWQ6IHguaWQsIENvdW50OiB4LmNvdW50LCBpbWFnZUlkOiB4LmltYWdlSWQgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2xlYXJBbGwgPSB0aGlzLmNsZWFyQWxsOwogICAgICB2YXIgcm91dGVyID0gdGhpcy4kcm91dGVyOwogICAgICBnbG9iYWwuYWpheFBvc3QoCiAgICAgICAgIi9hcGkvT3JkZXJTZXJ2aWNlL09yZGVyQ3JlYXRlL0V4Y3V0ZSIsCiAgICAgICAgeyBHb29kc0xpc3Q6IEdvb2RzTGlzdCB9LAogICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNsZWFyQWxsKCk7CiAgICAgICAgICBUb2FzdCh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICLorqLljZXliJvlu7rmiJDlip8iLCBkdXJhdGlvbjogMTUwMCwgb25DbG9zZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJvdXRlci5wdXNoKHsgbmFtZTogIm9yZGVybGlzdCIsIHBhcmFtczogeyB0eXBlOiAxIH0gfSkKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICApOwogICAgfSwKICAgIGdvaW5kZXgoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvaW5kZXgiKTsKICAgIH0sCiAgICBjaG9vc2VBTEwoKSB7CiAgICAgIHRoaXMuY2hlY2tlZEdvb2RzLmFsbGNoZWNrID0gIXRoaXMuY2hlY2tlZEdvb2RzLmFsbGNoZWNrOwogICAgICBpZiAodGhpcy5jaGVja2VkR29vZHMuYWxsY2hlY2spIHsKICAgICAgICB0aGlzLmdvb2RzLmZvckVhY2goeCA9PiAoeC5jaG9vc2UgPSB0cnVlKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5nb29kcy5mb3JFYWNoKHggPT4gKHguY2hvb3NlID0gZmFsc2UpKTsKICAgICAgfQogICAgfSwKICAgIGNoYW5nZUNhcnQoKSB7CiAgICAgIGdsb2JhbC5SZXNldFNob3BDYXJ0KHRoaXMuZ29vZHMpOwogICAgICB0aGlzLmNoZWNrQ2FydFN0YXRlKCk7CiAgICB9LAogICAgY2xlYXJBbGwoKSB7CiAgICAgIGdsb2JhbC5DbGVhclNob3BDYXJ0KAogICAgICAgIHRoaXMuZ29vZHMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5jaG9vc2UgPT0gZmFsc2U7CiAgICAgICAgfSkKICAgICAgKTsKICAgICAgdGhpcy5nb29kcyA9IGdsb2JhbC5HZXRTaG9wQ2FydCgpOwogICAgICB0aGlzLmNoZWNrQ2FydFN0YXRlKCk7CiAgICB9LAogICAgY2hlY2tDYXJ0U3RhdGUoKSB7CiAgICAgIHZhciBldmVyeVJlc3VsdCA9IHRoaXMuZ29vZHMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uY2hvb3NlID09IHRydWU7CiAgICAgIH0pOwogICAgICBpZiAoZXZlcnlSZXN1bHQubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBzdW0gPSAwLjA7CiAgICAgICAgZXZlcnlSZXN1bHQuZm9yRWFjaCh4ID0+IHsKICAgICAgICAgIHN1bSArPSB4LmNvdW50ICogeC5wcmljZTsKICAgICAgICB9KTsKICAgICAgICBpZiAoc3VtID4gMCkgewogICAgICAgICAgdGhpcy5jaGVja2VkR29vZHMudG90YWxQcmljZSA9IHN1bSAqIDEwMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jaGVja2VkR29vZHMudG90YWxQcmljZSA9IDAuMDsKICAgICAgICB9CiAgICAgICAgdGhpcy5jaGVja2VkR29vZHMuY2FuU3VibWl0ID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNoZWNrZWRHb29kcy50b3RhbFByaWNlID0gMC4wOwogICAgICAgIHRoaXMuY2hlY2tlZEdvb2RzLmNhblN1Ym1pdCA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nb29kcyA9IGdsb2JhbC5HZXRTaG9wQ2FydCgpOwogICAgdGhpcy5jaGVja0NhcnRTdGF0ZSgpOwogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/view/cart","sourcesContent":["<template>\n  <div>\n    <van-nav-bar left-arrow @click-left=\"goindex()\" title=\"我的购物车\" />\n    <ul style=\"padding-bottom: 50px;\">\n      <li v-for=\"item in goods\" :key=\"item.id\">\n        <van-cell>\n          <template slot=\"icon\">\n            <van-checkbox v-model=\"item.choose\" @change=\"changeCart()\" />\n            <van-image style=\"margin-left:10px;margin-right:10px\" width=\"100\" height=\"100\" :src=\"item.imageCode\" />\n          </template>\n          <template slot=\"title\">\n            <span class=\"custom-title\">{{item.name}}</span>\n          </template>\n          <template slot=\"label\">\n            <span class=\"custom-title\">￥{{item.price}}</span>\n          </template>\n          <template slot=\"default\">\n            <van-stepper @change=\"changeCart()\" v-model=\"item.count\" />\n          </template>\n        </van-cell>\n      </li>\n    </ul>\n    <van-submit-bar :price=\"checkedGoods.totalPrice\" :disabled=\"!checkedGoods.canSubmit\" button-text=\"结算\"\n      @submit=\"onSubmit\">\n      <van-checkbox v-model=\"checkedGoods.allcheck\" @click=\"chooseALL()\">全选</van-checkbox>\n      <van-button round size=\"small\" style=\"margin-left:10px\" @click=\"clearAll()\" type=\"info\">删除所选</van-button>\n    </van-submit-bar>\n  </div>\n</template>\n\n<script>\n  import global from \"../common\";\n  import {\n    Checkbox,\n    CheckboxGroup,\n    Card,\n    SubmitBar,\n    Toast,\n    Stepper,\n    Cell,\n    Image,\n    NavBar,\n    Button\n  } from \"vant\";\n\n  export default {\n    components: {\n      [Card.name]: Card,\n      [Checkbox.name]: Checkbox,\n      [SubmitBar.name]: SubmitBar,\n      [CheckboxGroup.name]: CheckboxGroup,\n      [Stepper.name]: Stepper,\n      [Cell.name]: Cell,\n      [Image.name]: Image,\n      [NavBar.name]: NavBar,\n      [Button.name]: Button\n    },\n\n    data() {\n      return {\n        checkedGoods: {\n          allcheck: false,\n          totalPrice: 0.0,\n          canSubmit: false\n        },\n        goods: []\n      };\n    },\n    methods: {\n      formatPrice(price) {\n        return (price / 100).toFixed(2);\n      },\n      onSubmit() {\n        //创建订单\n        var GoodsList = [];\n        this.goods.forEach(x => {\n          if (x.choose) GoodsList.push({ GoodsId: x.id, Count: x.count, imageId: x.imageId });\n        });\n        var clearAll = this.clearAll;\n        var router = this.$router;\n        global.ajaxPost(\n          \"/api/OrderService/OrderCreate/Excute\",\n          { GoodsList: GoodsList },\n          function () {\n            clearAll();\n            Toast({\n              message: \"订单创建成功\", duration: 1500, onClose: function () {\n                router.push({ name: \"orderlist\", params: { type: 1 } })\n              }\n            });\n          }\n        );\n      },\n      goindex() {\n        this.$router.push(\"/index\");\n      },\n      chooseALL() {\n        this.checkedGoods.allcheck = !this.checkedGoods.allcheck;\n        if (this.checkedGoods.allcheck) {\n          this.goods.forEach(x => (x.choose = true));\n        } else {\n          this.goods.forEach(x => (x.choose = false));\n        }\n      },\n      changeCart() {\n        global.ResetShopCart(this.goods);\n        this.checkCartState();\n      },\n      clearAll() {\n        global.ClearShopCart(\n          this.goods.filter(function (item) {\n            return item.choose == false;\n          })\n        );\n        this.goods = global.GetShopCart();\n        this.checkCartState();\n      },\n      checkCartState() {\n        var everyResult = this.goods.filter(function (item) {\n          return item.choose == true;\n        });\n        if (everyResult.length > 0) {\n          var sum = 0.0;\n          everyResult.forEach(x => {\n            sum += x.count * x.price;\n          });\n          if (sum > 0) {\n            this.checkedGoods.totalPrice = sum * 100;\n          } else {\n            this.checkedGoods.totalPrice = 0.0;\n          }\n          this.checkedGoods.canSubmit = true;\n        } else {\n          this.checkedGoods.totalPrice = 0.0;\n          this.checkedGoods.canSubmit = false;\n        }\n      }\n    },\n    mounted() {\n      this.goods = global.GetShopCart();\n      this.checkCartState();\n    }\n  };\n</script>\n\n<style lang=\"less\">\n  .card-goods {\n    padding: 10px 0;\n    background-color: #fff;\n\n    &__item {\n      position: relative;\n      background-color: #fafafa;\n\n      .van-checkbox__label {\n        width: 100%;\n        height: auto; // temp\n        padding: 0 10px 0 15px;\n        box-sizing: border-box;\n      }\n\n      .van-checkbox__icon {\n        top: 50%;\n        left: 10px;\n        z-index: 1;\n        position: absolute;\n        margin-top: -10px;\n      }\n\n      .van-card__price {\n        color: #f44;\n      }\n    }\n  }\n</style>"]}]}